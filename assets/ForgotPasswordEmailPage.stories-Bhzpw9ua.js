import{u as S,r,j as e}from"./iframe-BXIlaz2d.js";import{B as N}from"./BackHeader-Cx1EfD0_.js";import{F as g}from"./FieldLabel-BpkJpxf0.js";import{B as E}from"./Button-81gYiLei.js";import{w as P}from"./decorators-Cos6l-TR.js";import"./preload-helper-ByZkdcDp.js";function y(){const l=S(),[a,j]=r.useState(""),[o,v]=r.useState(""),[c,p]=r.useState(!1),[f,n]=r.useState(""),[d,m]=r.useState(!1);r.useEffect(()=>{const s=sessionStorage.getItem("verificationEmail");s?j(s):l.push("/forgot-password")},[l]);const u=o.length===6,b=async()=>{if(!c){p(!0);try{if(!(await fetch("/api/auth/request-verification",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a})})).ok)throw new Error("Ïû¨Ï†ÑÏÜ°Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.");alert("Ïù∏Ï¶ùÎ≤àÌò∏Í∞Ä Ïû¨Ï†ÑÏÜ°ÎêòÏóàÏäµÎãàÎã§.")}catch(s){console.error("Resend error:",s),alert("Ïû¨Ï†ÑÏÜ° Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.")}finally{p(!1)}}},h=async s=>{if(s.preventDefault(),!(!u||d)){console.log("üîç Ïù∏Ï¶ù ÏãúÎèÑ:",{email:a,verificationCode:o}),n(""),m(!0);try{const t=await fetch("/api/auth/verify-and-reset",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a,verificationCode:o})});if(console.log("üì° API ÏùëÎãµ ÏÉÅÌÉú:",t.status),!t.ok){const x=await t.json();console.log("‚ùå Ïù∏Ï¶ù Ïã§Ìå®:",x),n(x.error||"Ïù∏Ï¶ùÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.");return}const w=await t.json();console.log("‚úÖ Ïù∏Ï¶ù ÏÑ±Í≥µ:",w),sessionStorage.removeItem("verificationEmail"),sessionStorage.setItem("recoveryEmail",a),l.push("/forgot-password/success")}catch(t){console.error("üí• Verification error:",t),n("Ïù∏Ï¶ù Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.")}finally{m(!1)}}};return e.jsxs("div",{className:"bg-white flex flex-col h-screen mx-auto",style:{width:"var(--app-width)"},children:[e.jsx(N,{title:"ÏûÑÏãú ÎπÑÎ∞ÄÎ≤àÌò∏ Î∞úÍ∏â"}),e.jsxs("div",{className:"flex-1 px-4 py-8 overflow-y-auto flex flex-col justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-8",children:[e.jsxs("h1",{className:"title-1 text-on-surface",children:["ÏûÑÏãú ÎπÑÎ∞ÄÎ≤àÌò∏ Î∞úÍ∏âÏùÑ ÏúÑÌï¥",e.jsx("br",{}),"Í≥ÑÏ†ïÏù∏Ï¶ùÏùÑ ÏßÑÌñâÌï¥Ï£ºÏÑ∏Ïöî."]}),e.jsxs("form",{onSubmit:h,className:"flex flex-col gap-8",children:[e.jsxs("div",{className:"flex gap-2 items-end",children:[e.jsx("div",{className:"flex-1",children:e.jsx(g,{label:"Ïù¥Î©îÏùº",required:!0,value:a,fieldProps:{type:"email",readOnly:!0,disabled:!0}})}),e.jsx("button",{type:"button",onClick:b,disabled:c,className:"btn btn-secondary h-12 px-5 whitespace-nowrap",children:c?"Ï†ÑÏÜ° Ï§ë...":"Ïû¨Ï†ÑÏÜ°"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(g,{label:"Ïù∏Ï¶ùÎ≤àÌò∏ ÏûÖÎ†•",required:!0,placeholder:"Ïù∏Ï¶ùÎ≤àÌò∏ 6ÏûêÎ¶¨Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî",value:o,onChange:s=>{const t=s.target.value.replace(/\D/g,"").slice(0,6);v(t),n("")},fieldProps:{type:"text",maxLength:6,inputMode:"numeric",pattern:"[0-9]*"},error:f}),!f&&e.jsxs("div",{className:"flex flex-col gap-1 text-on-surface-subtle label-1",children:[e.jsxs("div",{className:"flex items-start gap-1",children:[e.jsx("span",{children:"‚Ä¢"}),e.jsx("span",{children:"Î©îÏùº ÎèÑÏ∞©ÍπåÏßÄ ÏµúÎåÄ 1~2Î∂Ñ Í±∏Î¶¥ Ïàò ÏûàÏñ¥Ïöî."})]}),e.jsxs("div",{className:"flex items-start gap-1",children:[e.jsx("span",{children:"‚Ä¢"}),e.jsx("span",{children:"Ïä§Ìå∏Ìï® ¬∑ ÌîÑÎ°úÎ™®ÏÖòÌï®ÏùÑ ÌôïÏù∏Ìï¥Î≥¥ÏÑ∏Ïöî."})]})]})]})]})]}),e.jsx(E,{variant:"primary",colorType:"accent",className:"w-full",onClick:h,disabled:!u||d,children:d?"ÌôïÏù∏ Ï§ë...":"Îã§Ïùå"})]})]})}y.__docgenInfo={description:"",methods:[],displayName:"ForgotPasswordEmailPage"};const F={title:"Pages/Auth/ForgotPasswordEmailPage",component:y,decorators:[P],parameters:{layout:"fullscreen",nextjs:{appDirectory:!0,navigation:{pathname:"/forgot-password/email"}}},tags:["autodocs"]},i={parameters:{docs:{description:{story:"ÎπÑÎ∞ÄÎ≤àÌò∏ Ï∞æÍ∏∞ 2Îã®Í≥Ñ - ÏûÑÏãú ÎπÑÎ∞ÄÎ≤àÌò∏Î•º Î∞õÏùÑ Ïù¥Î©îÏùº Ï£ºÏÜåÎ•º ÏûÖÎ†•Ìï©ÎãàÎã§."}}},beforeEach:()=>{sessionStorage.setItem("passwordRecoveryData",JSON.stringify({name:"ÌôçÍ∏∏Îèô",birthDate:"1990-01-01",phoneNumber:"010-1234-5678"}))}};i.parameters={...i.parameters,docs:{...i.parameters?.docs,source:{originalSource:`{
  parameters: {
    docs: {
      description: {
        story: 'ÎπÑÎ∞ÄÎ≤àÌò∏ Ï∞æÍ∏∞ 2Îã®Í≥Ñ - ÏûÑÏãú ÎπÑÎ∞ÄÎ≤àÌò∏Î•º Î∞õÏùÑ Ïù¥Î©îÏùº Ï£ºÏÜåÎ•º ÏûÖÎ†•Ìï©ÎãàÎã§.'
      }
    }
  },
  beforeEach: () => {
    // Mock sessionStorage for Storybook
    sessionStorage.setItem('passwordRecoveryData', JSON.stringify({
      name: 'ÌôçÍ∏∏Îèô',
      birthDate: '1990-01-01',
      phoneNumber: '010-1234-5678'
    }));
  }
}`,...i.parameters?.docs?.source}}};const T=["Default"];export{i as Default,T as __namedExportsOrder,F as default};
